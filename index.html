<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8" />
  <title>Chat</title>

  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Alpine.js -->
  <script src="https://unpkg.com/alpinejs" defer></script>
</head>

<body class="bg-gray-100 flex items-center justify-center h-screen p-6">

  <!-- –û—Å–Ω–æ–≤–Ω–∏–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä -->
  <div 
    x-data="chatApp()" 
    :class="accessToken ? 'bg-white p-6 rounded shadow-md w-[1000px]' : 'bg-white p-6 rounded shadow-md w-[400px]'"
    class="transition-all duration-300"
  >

    <!-- üîπ –§–û–†–ú–ê –õ–û–ì–Ü–ù–£ -->
    <template x-if="!accessToken">
      <div class="max-w-md mx-auto">
        <h2 class="text-2xl font-bold mb-4">–í—Ö—ñ–¥ —É —Å–∏—Å—Ç–µ–º—É</h2>

        <input x-model="username" placeholder="–Ü–º‚Äô—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞"
               class="border p-2 w-full mb-2 rounded" />

        <input x-model="password" type="password" placeholder="–ü–∞—Ä–æ–ª—å"
               class="border p-2 w-full mb-2 rounded" />

        <button 
          @click="login()" 
          class="bg-blue-500 hover:bg-blue-600 transition text-white p-2 w-full rounded"
        >
          –£–≤—ñ–π—Ç–∏
        </button>

        <p x-text="error" class="text-red-500 mt-3"></p>

        <p class="text-sm text-gray-500 mt-3">
          –ü–æ—Ä–∞–¥–∞: –Ω–µ –∑–±–µ—Ä—ñ–≥–∞–π—Ç–µ –ø–∞—Ä–æ–ª—ñ –≤ –∫–æ–¥—ñ. –í–≤–æ–¥—å—Ç–µ –ø–∞—Ä–æ–ª—å –ø—ñ–¥ —á–∞—Å —Ç–µ—Å—Ç—É.
        </p>
      </div>
    </template>

    <!-- üîπ –ü–ê–ù–ï–õ–¨ –ü–Ü–°–õ–Ø –ê–í–¢–û–†–ò–ó–ê–¶–Ü–á -->
    <template x-if="accessToken">
      <div class="space-y-4">
        <h1 class="text-2xl font-bold">‚úÖ –í–∏ —É—Å–ø—ñ—à–Ω–æ –∞–≤—Ç–æ—Ä–∏–∑—É–≤–∞–ª–∏—Å—å. –í–∞—à–∞ –ø–∞–Ω–µ–ª—å –∫–µ—Ä—É–≤–∞–Ω–Ω—è</h1>

        <!-- –í—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è Matrix ID -->
        <div class="mb-2 p-3 bg-gray-100 rounded text-sm break-words">
          <span class="font-semibold">–í–∞—à Matrix ID: </span>
          <span x-text="userId ? userId : '–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è...'"></span>
        </div>

        <!-- üîπ –ë–õ–û–ö –†–ï–ó–Æ–ú–ï -->
        <div class="p-4 bg-white border rounded shadow-sm">
          <h2 class="text-xl font-semibold mb-2">–ú–æ—î —Ä–µ–∑—é–º–µ</h2>
          <p>–ü—Ä–∏–≤—ñ—Ç! –ú–µ–Ω–µ –∑–≤–∞—Ç–∏ <strong>–ê–Ω–∞—Å—Ç–∞—Å—ñ—è –ë–∞–ª–∫–æ</strong>. –Ø —Å—Ç—É–¥–µ–Ω—Ç–∫–∞, —è–∫–∞ –Ω–∞–≤—á–∞—î—Ç—å—Å—è —Ä–æ–∑—Ä–æ–±—Ü—ñ –≤–µ–±–∑–∞—Å—Ç–æ—Å—É–Ω–∫—ñ–≤ —ñ —Å—Ç–≤–æ—Ä—é—é —Å–≤–æ—ó –ø–µ—Ä—à—ñ –ø—Ä–∞–∫—Ç–∏—á–Ω—ñ –ø—Ä–æ—î–∫—Ç–∏.</p>

          <h3 class="mt-4 font-semibold">–ú–æ—ó –Ω–∞–≤–∏—á–∫–∏</h3>
          <ul class="list-disc list-inside mt-2 text-gray-700">
            <li>HTML5 ‚Äî –≤–µ—Ä—Å—Ç–∫–∞ —Å—Ç–æ—Ä—ñ–Ω–æ–∫</li>
            <li>CSS (Tailwind) ‚Äî –∞–¥–∞–ø—Ç–∏–≤–Ω–∏–π –¥–∏–∑–∞–π–Ω</li>
            <li>JavaScript ‚Äî –ª–æ–≥—ñ–∫–∞ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—Ü—å–∫–æ–≥–æ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å—É</li>
            <li>Alpine.js ‚Äî —Ä–µ–∞–∫—Ç–∏–≤–Ω—ñ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∏</li>
            <li>Electron ‚Äî —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –¥–µ—Å–∫—Ç–æ–ø–Ω–∏—Ö –¥–æ–¥–∞—Ç–∫—ñ–≤</li>
          </ul>

          <h3 class="mt-4 font-semibold">–ú–æ—ó –ø—Ä–æ—î–∫—Ç–∏</h3>
          <table class="w-full mt-2 border-collapse text-sm">
            <thead>
              <tr class="bg-gray-50">
                <th class="border px-3 py-2 text-left">–ù–∞–∑–≤–∞</th>
                <th class="border px-3 py-2 text-left">–¢–µ—Ö–Ω–æ–ª–æ–≥—ñ—è</th>
                <th class="border px-3 py-2 text-left">–°—Ç–∞—Ç—É—Å</th>
              </tr>
            </thead>
            <tbody>
              <tr class="odd:bg-white even:bg-gray-50">
                <td class="border px-3 py-2">–ü–µ—Ä—à–∏–π –¥–æ–¥–∞—Ç–æ–∫</td>
                <td class="border px-3 py-2">Electron.js</td>
                <td class="border px-3 py-2">–í –ø—Ä–æ—Ü–µ—Å—ñ</td>
              </tr>
              <tr class="odd:bg-white even:bg-gray-50">
                <td class="border px-3 py-2">–ü–æ—Ä—Ç—Ñ–æ–ª—ñ–æ</td>
                <td class="border px-3 py-2">HTML / CSS</td>
                <td class="border px-3 py-2">–ó–∞–≤–µ—Ä—à–µ–Ω–æ</td>
              </tr>
            </tbody>
          </table>

          <h3 class="mt-4 font-semibold">–ö–æ–Ω—Ç–∞–∫—Ç–∏</h3>
          <ul class="list-disc list-inside mt-2 text-gray-700">
            <li>Email: nastiabalko@example.com</li>
            <li>Matrix ID: <span x-text="userId"></span></li>
          </ul>
        </div>

        <!-- –ö–Ω–æ–ø–∫–∞ –≤–∏—Ö–æ–¥—É -->
        <div>
          <button @click="logout()" class="bg-gray-200 hover:bg-gray-300 px-4 py-2 rounded">
            –í–∏–π—Ç–∏
          </button>
        </div>
      </div>
    </template>

  </div>

  <!-- üîπ –°–ö–†–ò–ü–¢ (–õ–û–ì–Ü–ö–ê –ê–í–¢–û–†–ò–ó–ê–¶–Ü–á) -->
  <script>
    function chatApp() {
      return {
        username: '',
        password: '',
        accessToken: '',
        userId: '',
        error: '',

        // –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—è —á–µ—Ä–µ–∑ Matrix API
        async login() {
          this.error = '';

          if (!this.username || !this.password) {
            this.error = '–ë—É–¥—å –ª–∞—Å–∫–∞, –≤–≤–µ–¥—ñ—Ç—å –ª–æ–≥—ñ–Ω —ñ –ø–∞—Ä–æ–ª—å';
            return;
          }

          try {
            const res = await fetch('https://matrix.org/_matrix/client/r0/login', {
              method: 'POST',
              headers: { 'Content-Type': 'application/json' },
              body: JSON.stringify({
                type: 'm.login.password',
                user: this.username,
                password: this.password
              })
            });

            const data = await res.json();

            if (res.ok && data.access_token) {
              this.accessToken = data.access_token;
              this.userId = data.user_id || `@${this.username}:matrix.org`;
              this.password = '';
              this.error = '';
            } else {
              if (data && data.errcode === 'M_FORBIDDEN') {
                this.error = '–ù–µ–≤—ñ—Ä–Ω–∏–π –ª–æ–≥—ñ–Ω –∞–±–æ –ø–∞—Ä–æ–ª—å';
              } else if (data && data.error) {
                this.error = `–ü–æ–º–∏–ª–∫–∞: ${data.error}`;
              } else {
                this.error = '–ù–µ –≤–¥–∞–ª–æ—Å—è –≤–∏–∫–æ–Ω–∞—Ç–∏ –≤—Ö—ñ–¥ ‚Äî —Å–ø—Ä–æ–±—É–π—Ç–µ –ø—ñ–∑–Ω—ñ—à–µ';
              }
            }
          } catch (e) {
            console.error(e);
            this.error = '–ü–æ–º–∏–ª–∫–∞ –ø—ñ–¥ —á–∞—Å –∑‚Äô—î–¥–Ω–∞–Ω–Ω—è –∑ —Å–µ—Ä–≤–µ—Ä–æ–º';
          }
        },

        // –í–∏—Ö—ñ–¥ –∑ –ø—Ä–æ—Ñ—ñ–ª—é
        logout() {
          this.accessToken = '';
          this.userId = '';
          this.username = '';
          this.password = '';
          this.error = '';
        }
      }
    }
  </script>

</body>
</html>
